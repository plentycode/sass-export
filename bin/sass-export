#!/usr/bin/env node

var sassExport = require('../dist').default;
var fs = require('fs');
var path = require('path');
var minimist = require('minimist');

var options = minimist(process.argv.slice(2), {
  alias: {
    f: 'files',
    o: 'output',
    h: 'help'
  }
});

var inputFiles = options._;

console.log(inputFiles);

if (!inputFiles.length || options.help) {
  fs.createReadStream(path.resolve(__dirname, 'help.txt'))
    .pipe(process.stdout)
    .on('close', () => {
      throw Error('Error reading help');
    });
  return;
}

if (!options.output) {
  options.output = inputFiles[0] + '-sass-exported.json';
}

var result = sassExport({
  inputFiles
});

fs.writeFileSync(options.output, JSON.stringify(result.getArray()));
console.log(`${options.output} was generated, go check it out!`);